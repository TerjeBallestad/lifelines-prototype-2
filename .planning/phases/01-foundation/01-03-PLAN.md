---
phase: 01-foundation
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/components/CharacterSprite.tsx
  - src/components/CharacterPanel.tsx
  - src/components/OverskuddMeter.tsx
  - src/components/ColorBadge.tsx
  - src/components/Game.tsx
autonomous: false

must_haves:
  truths:
    - "Player can click a character to view their stats"
    - "Character MTG color profile is visible (Blue 1.0, Green 0.4)"
    - "Overskudd meter visibly changes as needs decay"
    - "Character state is visible (overskudd, current activity)"
  artifacts:
    - path: "src/components/CharacterSprite.tsx"
      provides: "Clickable character representation"
      contains: "onClick"
    - path: "src/components/CharacterPanel.tsx"
      provides: "Character info panel on selection"
      contains: "observer"
    - path: "src/components/OverskuddMeter.tsx"
      provides: "Animated overskudd progress bar"
      contains: "useSpring"
    - path: "src/components/ColorBadge.tsx"
      provides: "MTG color display badges"
      contains: "MTG_COLORS"
  key_links:
    - from: "src/components/CharacterSprite.tsx"
      to: "src/stores/InteractionStore.ts"
      via: "selectCharacter action"
      pattern: "interactionStore\\.selectCharacter"
    - from: "src/components/CharacterPanel.tsx"
      to: "src/stores/CharacterStore.ts"
      via: "observer on character state"
      pattern: "character\\.(overskudd|needs|colors)"
    - from: "src/components/OverskuddMeter.tsx"
      to: "motion/react"
      via: "spring animation"
      pattern: "useSpring"
---

<objective>
Create character UI components: clickable sprites, info panel with MTG colors, and animated overskudd meter that responds to needs decay.

Purpose: This plan completes the foundation phase by making character state observable. Players can click characters to see their personality (MTG colors) and watch overskudd change over time as needs decay.

Output: Clickable characters, info panel showing MTG color profile and overskudd, animated meters that update in real-time.
</objective>

<execution_context>
@/Users/godstemning/.claude/get-shit-done/workflows/execute-plan.md
@/Users/godstemning/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-CONTEXT.md
@src/stores/CharacterStore.ts
@src/stores/InteractionStore.ts
@src/data/colors.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ColorBadge and OverskuddMeter components</name>
  <files>
    src/components/ColorBadge.tsx
    src/components/OverskuddMeter.tsx
  </files>
  <action>
Create src/components/ColorBadge.tsx:
- Display MTG color as a DaisyUI badge
- Import MTG_COLORS from data/colors.ts
- Props: { color: MTGColor, intensity: number }
- Show color letter (W/U/B/R/G) and intensity (e.g., "U 1.0")
- Use appropriate background/text colors from MTG_COLORS

Create src/components/OverskuddMeter.tsx:
- Use motion/react for spring animation (useSpring from motion/react)
- Props: { value: number } (0-100)
- DaisyUI progress bar with animated width
- Show numeric value alongside bar
- Spring config: stiffness 100, damping 30 (smooth but responsive)

Pattern from RESEARCH.md:
```typescript
import { motion, useSpring, useTransform } from 'motion/react';

function OverskuddMeter({ value }: { value: number }) {
  const springValue = useSpring(value, { stiffness: 100, damping: 30 });
  const width = useTransform(springValue, (v) => `${v}%`);
  // ... render progress bar with motion.div
}
```

IMPORTANT: Use `motion/react` import path, NOT `framer-motion` (deprecated path).
  </action>
  <verify>
    Components render without errors
    OverskuddMeter animates smoothly when value changes (test by changing prop)
    ColorBadge shows correct color styling
  </verify>
  <done>
    Reusable UI primitives for character display ready
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CharacterSprite, CharacterPanel, and wire into Game</name>
  <files>
    src/components/CharacterSprite.tsx
    src/components/CharacterPanel.tsx
    src/components/Game.tsx
  </files>
  <action>
Create src/components/CharacterSprite.tsx:
- Simple clickable representation of a character in the game world
- Props: { character: Character, onClick: () => void }
- Use observer() wrapper for reactive updates
- Display: Character name, small overskudd indicator
- DaisyUI card or avatar styling, positioned in game area
- Hover state with cursor-pointer

Create src/components/CharacterPanel.tsx:
- Full character info panel shown when character is selected
- Use observer() - CRITICAL for MobX reactivity
- Get selectedCharacter from interactionStore
- Use AnimatePresence from motion/react for enter/exit animations
- Display:
  - Character name (card-title)
  - MTG colors using ColorBadge (show primary and secondary if exists)
  - Overskudd meter using OverskuddMeter
  - Individual needs bars (energy, social, purpose) - simpler, no spring needed
  - Current activity (or "Idle" if null)
- Close button or click-outside to clear selection

Update src/components/Game.tsx:
- Import CharacterSprite and CharacterPanel
- Render game world area with both characters (Elling, Mother) as CharacterSprites
- Position characters with absolute positioning in a relative container
- Pass onClick to each sprite that calls interactionStore.selectCharacter(id)
- Render CharacterPanel outside the game world area (fixed position or below)
- Layout: TimeDisplay at top, game world in middle, CharacterPanel at bottom/side
  </action>
  <verify>
    Two characters visible in game world area
    Clicking a character highlights/selects them
    CharacterPanel appears with correct character info
    MTG colors display correctly (Elling: Blue 1.0, Green 0.4)
    Overskudd meter shows and animates as needs decay over time
  </verify>
  <done>
    Characters clickable and inspectable
    UI-01 and UI-04 requirements met
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 1 foundation: game loop with time display, clickable characters with MTG color profiles, and animated overskudd meters that respond to needs decay.
  </what-built>
  <how-to-verify>
1. Run `npm run dev` and open browser
2. Verify time display shows "Day 1" and time (starting ~07:00)
3. Watch time advance (minutes should tick up every few seconds)
4. Click pause button - time should freeze
5. Click play button - time should resume
6. Click on Elling character
7. Verify panel shows:
   - Name: "Elling"
   - Colors: Blue 1.0, Green 0.4 (as badges)
   - Overskudd meter (should be ~60-70 based on starting needs)
   - Individual needs (energy, social, purpose)
8. Click on Mother character
9. Verify panel shows:
   - Name: "Ella" (Mother)
   - Colors: White 0.7, Green 0.5
   - Similar overskudd/needs display
10. Let game run for 30+ seconds, watch overskudd meters slowly decrease
11. Verify the decrease is smooth (spring animated), not jerky

Expected: All Phase 1 success criteria met:
- Player sees time advancing
- Player can pause/resume time
- Player clicks character and sees MTG color profile
- Overskudd meter visibly changes as needs decay
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
1. `npm run dev` shows complete game interface
2. Time system: visible day/time, pause/play works
3. Characters: two sprites visible in game world
4. Selection: clicking character shows info panel
5. MTG colors: badges display correctly with intensity values
6. Overskudd: meters animate smoothly as needs decay
7. Needs decay: visible over 30+ seconds of gameplay
8. No console errors, no MobX warnings
</verification>

<success_criteria>
All Phase 1 requirements complete:
- TIME-01: Day/time progression visible
- TIME-02: Consistent tick rate (fixed timestep)
- TIME-03: Pause/play functional
- TIME-04: Day counter and time indicator visible
- CHAR-01: MTG colors with intensities displayed
- CHAR-05: Overskudd meter visible and functional
- CHAR-06: Needs affect overskudd (decay visible)
- UI-01: Click characters to view stats
- UI-04: Character state visible (overskudd, activity)

Phase 1 Success Criteria from ROADMAP:
1. Player sees time advancing (day counter increments, hour/minute visible)
2. Player can pause/resume time, game state stops/resumes
3. Player clicks character and sees MTG color profile
4. Overskudd meter visibly changes as needs decay
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
